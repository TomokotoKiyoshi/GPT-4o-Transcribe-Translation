# リアルタイム日本語字幕転写システム（キーワード機能付き）

## 🧩 概要

本プログラムは、GPT-4o API を活用した**多言語対応のリアルタイム音声文字起こし・翻訳システム**です。美しくモダンなGUI（グラフィカルユーザーインターフェース）を備え、マイクを接続して「録音開始」をクリックするだけで、日本語（または他言語）の音声を即座に文字として取得できます。さらに、英語・中国語などへの翻訳にも対応し、フローティング字幕ウィンドウでの表示も可能です。

会議記録、語学学習、字幕支援などのシーンで活躍します。

---

## 🚀 使用方法

### 1. 準備

以下のファイル／フォルダが揃っていることを確認してください：

- `RealTime_Jp2txt.exe`：実行可能ファイル（ダブルクリックで起動）

- `API_Key.txt`：OpenAI の API Key を保存したテキストファイル

### 2. API Key の設定

- `API_Key.txt` という名前のテキストファイルを作成し、1行目に有効な OpenAI API Key を記入します：
  
  ```
  sk-XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
  ```

> ⚠️ `API_Key.txt` をインターネット上で公開したり、他人と共有しないでください！

### 3. プログラムの起動

- `RealTime_Jp2txt.exe` をダブルクリックするとプログラムが起動します。 **右側の`Releases` からダウンロード**

- GUI が自動的に立ち上がり、コマンド操作は不要です。

### 4. 操作ガイド

- **キーワード入力欄**：現在の音声テーマに関するキーワードを入力（任意）。モデルが文脈を理解しやすくなります。

- **文字起こし言語**：ドロップダウンから対象音声の言語を選択（初期値は日本語）。`auto` に設定すれば自動検出も可能。

- **翻訳言語**：転写結果を翻訳するかを選択。初期値は英語。

- **🎙️ 録音開始**：クリックすると録音を開始し、音声は4秒ごとに転写されます。

- **⏹️ 録音停止**：録音を停止。すでに転写された字幕は保持されます。

- **🖥️ フローティング字幕**：画面下部に半透明・枠なしの字幕ウィンドウが表示され、最新2行の字幕を常に表示。ドラッグ・拡大縮小・フォントサイズ変更も可能です。

- **音声レベルバー**：マイク音量の強さをリアルタイムで表示。

- **字幕表示エリア**：メインウィンドウ中央に、タイムスタンプ付きの原文・翻訳文がスクロール表示されます。

---

## 🧠 主な機能

### ✅ リアルタイム音声認識（文脈の継続性に配慮）

- GPT-4o Transcribe を使用し、4秒単位＋0.8秒の重複部分で音声を分割・送信。前後の文脈を保った転写が可能です。

### ✅ キーワードによる文脈補助

- 初回リクエスト時にキーワードをプロンプトに含めることで、モデルが状況を理解しやすくなります（例：「医学会議」「ニュース取材」など）。

### ✅ 多言語対応の転写と翻訳

- **転写対応言語**：
  
  - 日本語、英語、中国語、韓国語など多数。
  
  - `auto` による自動言語検出もサポート。

- **翻訳対応言語**：
  
  - 英語、日本語、中国語、フランス語、スペイン語、アラビア語、インドネシア語など。

### ✅ フローティング字幕表示

- 画面上に常時表示される字幕ウィンドウ（最前面表示、調整可能）。

- PowerPoint 等と併用することで、プレゼン中でも字幕を確認可能。

### ✅ 非同期処理で快適な動作

- 音声録音・転写・翻訳が個別スレッドで動作し、互いに干渉しません。

- GUI は常に軽快に動作し、遅延やフリーズはありません。

---

## 📂 フォルダ構成

```
Translation/
├── RealTime_Jp2txt.exe             # 実行ファイル（ダブルクリックで起動）
├── API_Key.txt                     # OpenAI API Key を記入したテキストファイル
├── Pycode/                         # ソースコードフォルダ（Python モジュール）
│   └── RealTime_Transcription.py   # メインロジック（存在する場合）
```

| パス                    | 説明                       |
| --------------------- | ------------------------ |
| `Translation/`        | プログラム全体のルートフォルダ          |
| `RealTime_Jp2txt.exe` | メイン実行ファイル（GUI付き）         |
| `API_Key.txt`         | OpenAI API Key を記載するファイル |
| `Pycode/`             | 開発者用ソースコードディレクトリ         |
| `Pycode/*.py`         | Python スクリプトファイル群        |

> 🛠️ 開発者向け：`Pycode/` を編集し、`PyInstaller` などで再パッケージ可能です。

---

## 💡 注意点

- プログラム起動前に、インターネット接続が安定していることを確認してください。

- OpenAI アカウントで GPT-4o の利用権限がある必要があります（API 呼び出しが失敗する可能性があります）。

---

## 📞 サポート

問題が発生した場合は、次の点をご確認ください：

- API Key が無効、または利用上限に達している

- ネットワーク接続が不安定

- マイクデバイスが接続されていない／認識されていない

- 音声フォーマットの変換に失敗（デフォルト設定を推奨）

---

📧 ご不明な点や問題がございましたら、作者（heu_xuyouyan@outlook.com）までご連絡ください。

独自の字幕・転写システムを構築したい方は、本プログラムをベースにカスタマイズすることも可能です。
